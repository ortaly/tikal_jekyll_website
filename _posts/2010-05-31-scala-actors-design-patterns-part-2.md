---
layout: post
title: Scala actors design patterns - part 2
created: 1275278385
author: ittayd
permalink: /java/scala-actors-design-patterns-part-2
tags:
- JAVA
- Scala
- scala actors
---
<p>&nbsp;In the previous post, I discussed how to handle sending data from an actor in response to a message (request) from another. This time I want to discuss how to handle that response.</p>
<p>&nbsp;</p>
<p class="MsoNormal">In the simple case, an actor sends a request, and awaits a response:</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;;
color:#000066">actor</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; anotherActor<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Request</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; react<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; &nbsp;<span class="apple-converted-space">&nbsp;</span><b>case</b><span class="apple-converted-space">&nbsp;</span>Response<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">....</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">}</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">}<o:p></o:p></span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">This is fine for this case, but what if we&rsquo;re expecting interleaving response messages? Imagine a fork-join type of solution. An actor forks a task to smaller ones by sending requests to several actors and then waits for the responses from them.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;;
color:#000066">actor</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span><b>for</b><span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">((</span><span style="font-family:&quot;Courier New&quot;;color:#000066">i, anActor</span><span style="font-family:
&quot;Courier New&quot;;color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">&lt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">- actors.</span><span style="font-family:
&quot;Courier New&quot;;color:black">zipWithIndex</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">taskActor</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Request</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">i</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066">, i</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
&nbsp; react<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; &nbsp;<span class="apple-converted-space">&nbsp;</span><b>case</b><span class="apple-converted-space">&nbsp;</span>Response</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">i</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><i><span style="font-family:&quot;Courier New&quot;;color:green">// join task i's result</span></i><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">}</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">}<o:p></o:p></span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">What we have required from the message protocol is to send back the index of the requested task. The index is not used in the actor handling the task, but is required by the requester.</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">What if we want to implement the forking and joining in another way? E.g., there&rsquo;s a meta-data associated with each task that is referenced by an ID, not a simple index.<span style="mso-spacerun:yes">&nbsp; </span>Should we change the protocol?</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">In cases like this, the pattern is to create the Request-Response protocol so that the Request message has an opaque argument that is put in the response the way it came. This sort of data is sometimes called a cookie</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b><span style="font-family:
&quot;Courier New&quot;;color:#000066">case</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><b><span style="font-family:&quot;Courier New&quot;;color:#000066">class</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Requset</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">[</span><span style="font-family:&quot;Courier New&quot;;color:#000066">T</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">](</span><span style="font-family:&quot;Courier New&quot;;color:navy">&lt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">other arguments</span><span style="font-family:
&quot;Courier New&quot;;color:navy">&gt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">, cookie</span><span style="font-family:&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">T</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
<b>case</b><span class="apple-converted-space">&nbsp;</span><b>class</b><span class="apple-converted-space">&nbsp;</span>Response</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">[</span><span style="font-family:&quot;Courier New&quot;;color:#000066">T</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">](</span><span style="font-family:&quot;Courier New&quot;;color:navy">&lt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">other arguments</span><span style="font-family:
&quot;Courier New&quot;;color:navy">&gt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">, cookie</span><span style="font-family:&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">T</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)<o:p></o:p></span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">This can be combined with the pattern from the previous post:</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b><span style="font-family:
&quot;Courier New&quot;;color:#000066">case</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><b><span style="font-family:&quot;Courier New&quot;;color:#000066">class</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Requset</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">[</span><span style="font-family:&quot;Courier New&quot;;color:#000066">T, U</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">](</span><span style="font-family:&quot;Courier New&quot;;color:navy">&lt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">other arguments</span><span style="font-family:
&quot;Courier New&quot;;color:navy">&gt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066">, extract</span><span style="font-family:&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">T</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">U</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
<b>type</b><span class="apple-converted-space">&nbsp;</span>MyRequest<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Request</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">[</span><span style="font-family:&quot;Courier New&quot;;color:#000066">Result, MyResponse</span><span style="font-family:
&quot;Courier New&quot;;color:#F78811">]</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
<b>case</b><span class="apple-converted-space">&nbsp;</span><b>class</b><span class="apple-converted-space">&nbsp;</span>MyResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span style="font-family:&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Result, id</span><span style="font-family:&quot;Courier New&quot;;
color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">String</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
<br />
<b>val</b><span class="apple-converted-space">&nbsp;</span>task<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">tasks</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">id</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
taskActor<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">MyRequest</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task,</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">MyResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, id</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)})<o:p></o:p></span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Now imagine a case where tasks are not the same. There are several types of tasks, each requiring a different type of handling on response. One way is for the cookie to contain the task type and branch accordingly when handling the response (&ldquo;if (theType == &hellip;)&hellip;&rdquo;). Another way is by having the &lsquo;extract&rsquo; callback above create different response messages:</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;;
color:#000066">taskActor</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;new </span></span><span style="font-family:&quot;Courier New&quot;;
color:#000066">MyRequest</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task,</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">OneResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, id</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)})</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
taskActor<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;new </span></span><span style="font-family:&quot;Courier New&quot;;
color:#000066">MyRequest</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task,</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">AnotherResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, id</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)})</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
<br />
react<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span><b>case</b><span class="apple-converted-space">&nbsp;</span>OneResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, id</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><i><span style="font-family:&quot;Courier New&quot;;color:green">// handle tasks of type one</span></i><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span><b>case</b><span class="apple-converted-space">&nbsp;</span>AnotherResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, id</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><i><span style="font-family:&quot;Courier New&quot;;color:green">// handle tasks of another type</span></i><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">}<o:p></o:p></span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">The problem here is that as task types grow, we need to add more response messages. <span style="mso-spacerun:yes">&nbsp;</span></p>
<p class="MsoNormal">An alternative is to encode the code handling the response inside the request construction:</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><b><span style="font-family:
&quot;Courier New&quot;;color:#000066">case</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><b><span style="font-family:&quot;Courier New&quot;;color:#000066">class</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">MyResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span style="font-family:&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Result, callback</span><span style="font-family:
&quot;Courier New&quot;;color:navy">:</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Result</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">Unit</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
<br />
taskActor<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><b><span style="font-family:&quot;Courier New&quot;;color:#000066">new</span></b><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">MyRequest</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task,</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; MyResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r,</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp; &nbsp;<span class="apple-converted-space">&nbsp;</span></span><i><span style="font-family:&quot;Courier New&quot;;color:green">// handle the result accordig to the type of task</span></i><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">}</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">})</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
<br />
react<span class="apple-converted-space">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp;<b>case</b><span class="apple-converted-space">&nbsp;</span>MyResponse</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r, callback</span><span style="font-family:
&quot;Courier New&quot;;color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">callback</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">}</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">This has several benefits:</p>
<ul style="margin-top:0cm" type="disc">
    <li class="MsoNormal" style="mso-list:l0 level1 lfo1">The logic to request and      handle the response is in one place in the code, making it easier to      understand what is happening</li>
    <li class="MsoNormal" style="mso-list:l0 level1 lfo1">The context at the scope      of constructing the request is available to the callback. There&rsquo;s no need      to explicitly pass the id used before in the request and response,      instead, the callback just uses it</li>
</ul>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">Since much of the code above is boilerplate, it can be sugar coated :</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;;
color:#000066">taskActor</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">!</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#000066">request</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">(</span><span style="font-family:&quot;Courier New&quot;;color:#000066">task</span><span style="font-family:&quot;Courier New&quot;;color:#F78811">)</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:#F78811">{</span><span style="font-family:&quot;Courier New&quot;;color:#000066">r</span><span class="apple-converted-space"><span style="font-family:&quot;Courier New&quot;;color:#000066">&nbsp;</span></span><span style="font-family:&quot;Courier New&quot;;color:navy">=&gt;</span><span style="font-family:&quot;Courier New&quot;;color:#000066"><br />
&nbsp;<span class="apple-converted-space">&nbsp;</span></span><i><span style="font-family:&quot;Courier New&quot;;color:green">// handle the result</span></i><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
</span><span style="font-family:&quot;Courier New&quot;;
color:#F78811">}</span><span style="font-family:&quot;Courier New&quot;;
color:#000066"><br />
&nbsp;</span><br style="mso-special-character:
line-break" />
<br style="mso-special-character:line-break" />
<span lang="HE" dir="RTL" style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri"><o:p></o:p></span></p>
<p>&nbsp;</p>
