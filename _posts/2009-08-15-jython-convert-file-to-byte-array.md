---
layout: post
title: Jython - Convert File to Byte Array
created: 1250327340
author: liorb
permalink: /jython-convert-file-byte-array
tags:
- Flex Java
---
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_tECzk8Tdl88/SoZ93xag3jI/AAAAAAAAAEA/aQ_fwjPOr90/s1600-h/jython-logo.jpg"><img style="margin: 0pt 10px 10px 0pt; float: left; cursor: pointer; width: 100px; height: 65px;" src="http://4.bp.blogspot.com/_tECzk8Tdl88/SoZ93xag3jI/AAAAAAAAAEA/aQ_fwjPOr90/s400/jython-logo.jpg" alt="" id="BLOGGER_PHOTO_ID_5370118002796715570" border="0" /></a><br />I've recently started developing with Jython and I love the language. the combination of Python's dynamic features with Java is extremely powerful. If you are not familiar with <a href="http://www.python.org/">Python</a> or <a href="http://www.jython.org/">Jython</a>, be sure to check the above links. As an Action Script veteran, I have to admit that Python makes me miss the early days of AS, when the language was dynamic and weakly typed.<br /><br />The following is an example of a typical web client task, a conversion of a local file to a Byte array, such a conversion is common when sending a local file from the client to a Java server, using SOAP Web Services or other integration layer. Here is an example of a file to Byte array conversion in Jython, it's a Jython version of a simple java code I've found <a href="http://www.java-tips.org/java-se-tips/java.io/reading-a-file-into-a-byte-array.html">here</a>:<br /><br /><pre face="Andale Mono,Lucida Console,Monaco,fixed,monospace" size="12px" style="border: 1px dashed rgb(153, 153, 153); padding: 5px; overflow: auto; color: rgb(0, 0, 0); background-color: rgb(238, 238, 238); line-height: 14px; width: 90%;"><code>from java.lang import Byte<br />from java.io import FileInputStream<br />from java.io import File<br />import jarray<br /><br />def getByteArray(self,fileUrl):<br />  file = File(fileUrl);<br />  inputStream = FileInputStream(file)<br />  length = file.length()<br />  bytes = jarray.zeros(length, 'b')<br />  #Read in the bytes<br />  offset = 0<br />  numRead = 0<br />  while offset<length:<br />      if numRead>= 0:<br />          print numRead<br />          numRead=inputStream.read(bytes, offset, length-offset)<br />          offset = offset + numRead<br />  return bytes<br /></code></pre><br />As you can see, I had to use the <a href="http://book.opensourceproject.org.cn/lamp/python/pythonjava/opensource/0201616165_ch11lev1sec4.html">jarray</a> Jython module in this code. Jarray provides a much needed API that is missing from Jython's core modules. It exposes two methods which allow you to construct Typed Arrays and\or determine the array length on creation. The following are the two jarray methods:<span style="font-weight: bold;"><br /><br /><span style="font-style: italic;">array(sequence, type):</span></span><span style="font-style: italic;"> Creates an array of a specific type with values from the sequence; the array is the same size as the sequence</span><span style="font-weight: bold; font-style: italic;"><br /><br />zeros(length, type):</span><span style="font-style: italic;"> Creates an empty array the length of the length parameter</span><br /><br />The follwoing line in my code:<br /><br /><pre face="Andale Mono,Lucida Console,Monaco,fixed,monospace" size="12px" style="border: 1px dashed rgb(153, 153, 153); padding: 5px; overflow: auto; color: rgb(0, 0, 0); background-color: rgb(238, 238, 238); line-height: 14px; width: 90%;"><code>bytes = jarray.zeros(length, 'b')</code></pre><br />Is the jarray, Jython implementation of the following java code:<br /><br /><pre style="border: 1px dashed rgb(153, 153, 153); padding: 5px; overflow: auto; font-family: Andale Mono,Lucida Console,Monaco,fixed,monospace; color: rgb(0, 0, 0); background-color: rgb(238, 238, 238); font-size: 12px; line-height: 14px; width: 90%;"><code><span style="color: rgb(127, 0, 85);"><b>byte</b></span><span style="color: rgb(0, 0, 0);">[] </span><span style="color: rgb(0, 0, 0);">bytes = </span><span style="color: rgb(127, 0, 85);"><b>new </b></span><span style="color: rgb(127, 0, 85);"><b>byte</b></span><span style="color: rgb(0, 0, 0);">[(</span><span style="color: rgb(127, 0, 85);"><b>int</b></span><span style="color: rgb(0, 0, 0);">)</span><span style="color: rgb(0, 0, 0);">length</span><span style="color: rgb(0, 0, 0);">]</span><span style="color: rgb(0, 0, 0);">;</span></code></pre>
